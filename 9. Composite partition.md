# Composite partition

### Definition
We can easily understand that **Composite Partition** is **partition contains partitions**.</br>

### Types
It is the combination between 3 kinds of partitioning: **List**, **Range** and **Hash**. So we will have:
- Composite Range-Range Partitioning
- Composite Range-Hash Partitioning
- Composite Range-List Partitioning
- Composite List-List Partitioning
- Composite List-Range Partitioning
- Composite List-Hash Partitioning
- Composite Hash-Hash Partitioning
- Composite Hash-List Partitioning
- Composite Hash-Range Partitioning

### Examples
In this part, we just focus on the most common composite partitions:

#### List - List
- List Partition by SURVEY_YEAR
- List Subpartitionby RESPONDENT_GENDER
```
CREATE TABLE CANDYHIST_COMPPART
(
  RESPONDENT_ID NUMBER,
  RESPONDENT_GENDER VARCHAR2(1),
  SURVEY_YEAR NUMBER,
  NBR_BARS_CONSUMED NUMBER
)
PARTITION BY LIST (SURVEY_YEAR)
    SUBPARTITION BY LIST (RESPONDENT_GENDER)
    SUBPARTITION TEMPLATE (SUBPARTITION P_MALE   VALUES('M','m'),
                           SUBPARTITION P_FEMALE VALUES('F','f'),
                           SUBPARTITION P_OTHER  VALUES(DEFAULT))
(
PARTITION P_45678 VALUES(2004,2005,2006,2007,2008),
PARTITION P_90123 VALUES(2009,2010,2011,2012,2013)
);

----
CREATE TABLE accounts
( id             NUMBER
, account_number NUMBER
, customer_id    NUMBER
, balance        NUMBER
, branch_id      NUMBER
, region         VARCHAR(2)
, status         VARCHAR2(1)
)
PARTITION BY LIST (region)
SUBPARTITION BY LIST (status)
( PARTITION p_northwest VALUES ('OR', 'WA')
  ( SUBPARTITION p_nw_bad VALUES ('B')
  , SUBPARTITION p_nw_average VALUES ('A')
  , SUBPARTITION p_nw_good VALUES ('G')
  )
, PARTITION p_southwest VALUES ('AZ', 'UT', 'NM')
  ( SUBPARTITION p_sw_bad VALUES ('B')
  , SUBPARTITION p_sw_average VALUES ('A')
  , SUBPARTITION p_sw_good VALUES ('G')
  )
, PARTITION p_northeast VALUES ('NY', 'VM', 'NJ')
  ( SUBPARTITION p_ne_bad VALUES ('B')
  , SUBPARTITION p_ne_average VALUES ('A')
  , SUBPARTITION p_ne_good VALUES ('G')
  )
, PARTITION p_southeast VALUES ('FL', 'GA')
  ( SUBPARTITION p_se_bad VALUES ('B')
  , SUBPARTITION p_se_average VALUES ('A')
  , SUBPARTITION p_se_good VALUES ('G')
  )
, PARTITION p_northcentral VALUES ('SD', 'WI')
  ( SUBPARTITION p_nc_bad VALUES ('B')
  , SUBPARTITION p_nc_average VALUES ('A')
  , SUBPARTITION p_nc_good VALUES ('G')
  )
, PARTITION p_southcentral VALUES ('OK', 'TX')
  ( SUBPARTITION p_sc_bad VALUES ('B')
  , SUBPARTITION p_sc_average VALUES ('A')
  , SUBPARTITION p_sc_good VALUES ('G')
  )
);
```
Manage Partition/ Sub-Partition by **USER_TAB_PARTITIONS** and **USER_TAB_SUBPARTITIONS**
```
SELECT COMPOSITE,
       PARTITION_NAME,
       SUBPARTITION_COUNT,
       HIGH_VALUE
  FROM USER_TAB_PARTITIONS
 WHERE TABLE_NAME='CANDYHIST_COMPPART'
 ORDER BY PARTITION_POSITION;
 
SELECT TABLE_NAME,
       PARTITION_NAME,
       SUBPARTITION_NAME,
       HIGH_VALUE,
       SUBPARTITION_POSITION
  FROM USER_TAB_SUBPARTITIONS
 WHERE TABLE_NAME='CANDYHIST_COMPPART'
 ORDER BY PARTITION_NAME, SUBPARTITION_POSITION; 
```

#### Range - List
- Range Partition by SURVEY_DATE
- List Subpartitionby LIKELIHOOD_PURCHASE(1 to 10)
